"use strict";(self.webpackChunkpiket=self.webpackChunkpiket||[]).push([[6383],{9822:function(e,a,s){s.d(a,{v:function(){return o}});var r=s(4165),n=s(5861),l=s(885),i=s(2791),t=s(4072),o=function(e){var a=(0,i.useState)(!1),s=(0,l.Z)(a,2),o=s[0],c=s[1],d=(0,i.useState)(!1),u=(0,l.Z)(d,2),m=u[0],p=u[1],f=(0,t.Z)(),h=e.apiPath,v=e.value;function x(){return(x=(0,n.Z)((0,r.Z)().mark((function e(){var a,s;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a=encodeURIComponent(v.trim()))){e.next=9;break}return p(!0),e.next=6,f.get("".concat(h,"/").concat(a));case 6:"true"===(null===(s=e.sent)||void 0===s?void 0:s.data.toString())?c(!0):c(!1),p(!1);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return e.children({loading:m,check:function(){return x.apply(this,arguments)},exist:o})}},5815:function(e,a,s){s.d(a,{Q:function(){return h}});var r=s(4165),n=s(5861),l=s(885),i=s(2791),t=s(1128),o=s(7162),c=s(919),d=s(894),u=s(3306),m=s(4072),p=s(6884),f=s(184),h=function(e){var a=(0,d.Z)(),s=(0,m.Z)(),h=(0,u.Z)(),v=(0,i.useRef)(null),x=(0,i.useState)([]),g=(0,l.Z)(x,2),j=g[0],N=g[1],b=(0,i.useState)([]),w=(0,l.Z)(b,2),C=w[0],S=w[1],Z=(0,i.useState)(!1),_=(0,l.Z)(Z,2),y=_[0],k=_[1];(0,i.useEffect)((function(){if(e.value){var a=e.value.toString().split(",");N(a)}}),[e.value]);var P=e.maxFileSize||10,F=e.fileLimit||10,E=e.multiple,U=e.accept,B=1024*P*1024;function D(){var e=[];j.forEach((function(s){var r=s.split("\\").pop().split("/").pop(),n=r.split(".").pop().toLowerCase(),l=!1;["jpg","png","gif","jpeg","bmp"].indexOf(n)>-1&&(l=!0);var i="small";s.indexOf("temp/")>-1&&(i="");var t=a.strEllipsis(r,15);e.push({name:r,shortName:t,isImage:l,size:i,path:s})})),S(e)}function T(){e.onChange(j.toString())}function z(e){return V.apply(this,arguments)}function V(){return(V=(0,n.Z)((0,r.Z)().mark((function e(a){var n,l;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,-1===(n=j.indexOf(a.path))){e.next=11;break}return j.splice(n,1),N(j),D(),T(),"fileuploader/remove_temp_file",l={temp_file:a.path},e.next=11,s.post("fileuploader/remove_temp_file",l);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.error(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})))).apply(this,arguments)}function A(){return e.showUploadedFiles&&C.length?(0,f.jsx)("div",{className:"flex gap-2 flex-wrap py-2",children:C.map((function(e){return(0,f.jsxs)("div",{children:[e.isImage&&(0,f.jsxs)("div",{className:"card flex justify-content-between gap-2 align-items-center p-1",children:[(0,f.jsx)(p.O,{width:"40px",height:"40px",imageSize:"small",src:e.path}),(0,f.jsx)(c.z,{type:"button",className:"p-button-danger p-button-sm p-button-text",onClick:function(){return z(e)},icon:"pi pi-times"})]}),!e.isImage&&(0,f.jsxs)("div",{className:"flex card p-1 gap-2 justify-content-between align-items-center p-1",children:[(0,f.jsx)("a",{target:"_blank",rel:"noreferrer",href:a.getFileFullPath(e.path),children:(0,f.jsx)(o.q,{size:"large",icon:"pi pi-file"})}),(0,f.jsx)("span",{className:"text-sm text-500",children:e.shortName}),(0,f.jsx)(c.z,{type:"button",className:"p-button-danger p-button-sm p-button-text",onClick:function(){return z(e)},icon:"pi pi-times"})]})]},e.path)}))}):null}(0,i.useEffect)((function(){D(),j.length>=F?k(!0):k(!1)}),[j,j.length,F]);return(0,f.jsxs)("div",{className:"p-2 surface-200",children:[(0,f.jsx)(t.p,{disabled:y,name:"file",ref:v,auto:!0,maxFileSize:B,accept:U,multiple:E,mode:"advanced",url:a.setApiPath(e.uploadPath),onBeforeSend:function(e){var a=h.getToken();e.xhr.setRequestHeader("Authorization","Bearer ".concat(a))},onUpload:function(a){var s=a.xhr.response;j.push(s),N(j),T(),e.onUploadCompleted(s)},onError:function(a){var s,r=(null===a||void 0===a||null===(s=a.xhr)||void 0===s?void 0:s.response)||"Unable to upload file";e.onUploadError(r)},emptyTemplate:function(){return(0,f.jsxs)("div",{className:"flex justify-content-center align-items-center gap-3 text-500",children:[(0,f.jsx)("i",{className:"pi pi-upload text-5xl"}),(0,f.jsx)("span",{className:"font-bold",children:e.label})]})}}),(0,f.jsx)(A,{})]})};h.defaultProps={onChange:function(){},onUploadCompleted:function(){},onUploadError:function(){}}},7842:function(e,a,s){var r=s(4165),n=s(5861),l=s(1413),i=s(885),t=s(2791),o=s(4018),c=s(1933),d=s(4072),u=s(4621);a.Z=function(e){var a=e.props,s=e.formDefaultValues,m=e.afterSubmit,p=(0,o.Z)(),f=(0,d.Z)(),h=(0,t.useState)(!0),v=(0,i.Z)(h,1)[0],x=p.getPageFormData(a.pageName),g=a.formData,j=(0,l.Z)((0,l.Z)((0,l.Z)({},s),g),x),N=(0,t.useState)(j),b=(0,i.Z)(N,2),w=b[0],C=b[1],S=(0,c.useQueryClient)(),Z=(0,c.useMutation)((function(e){var s,r=a.apiPath;s=Array.isArray(e)?e.map((function(e){return _(e)})):_(e);return f.post(r,s).then((function(e){return null===e||void 0===e?void 0:e.data}))}),{retry:!1,onSuccess:function(e){S.invalidateQueries(a.pageName),m&&m(e)},onError:function(e){p.showPageRequestError(e)}});function _(e){var a=(0,l.Z)({},e);return Object.keys(a).forEach((function(e){var s=a[e];if(Array.isArray(s)){var r=s[0];a[e]=r&&"string"==typeof r?s.toString():s}else s instanceof Date?a[e]=s.toISOString().slice(0,19).replace("T"," "):""===s&&(a[e]=null)})),a}var y={setFormData:C,submitForm:function(e){var s=a.msgBeforeSave;s?(0,u.V)({header:a.msgTitle,message:s,icon:"pi pi-save",accept:function(){var a=(0,n.Z)((0,r.Z)().mark((function a(){return(0,r.Z)().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:Z.mutate(e);case 1:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}(),reject:function(){}}):Z.mutate(e)},inputClassName:function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"w-full";return e?"".concat(a," p-invalid"):a},resetForm:function(){C(j)},handleSubmit:function(e,s){s.isValid||p.flashMsg(a.formValidationError,a.formValidationMsg,"error")},formData:w,pageReady:v,saving:Z.isLoading};return(0,t.useMemo)((function(){return y}),[w,v,Z.isLoading])}},6383:function(e,a,s){s.r(a);var r=s(5705),n=s(9562),l=s(919),i=s(9822),t=s(9025),o=s(905),c=s(2557),d=s(3898),u=s(5815),m=s(4018),p=s(7842),f=s(184),h=function(e){var a=(0,m.Z)(),s=n.Ry().shape({username:n.Z_().required().label("Username"),password:n.Z_().required().label("Password"),confirm_password:n.Z_().required().label("Confirm Password").oneOf([n.iH("password")],"Your passwords do not match"),email:n.Z_().email().required().label("Email"),telp:n.Z_().nullable().label("Telp"),foto_user:n.Z_().required().label("Foto User")}),h=(0,p.Z)({props:e,formDefaultValues:{username:"",password:"",confirm_password:"",email:"",telp:"NULL",foto_user:""},afterSubmit:function(s){a.flashMsg(e.msgTitle,e.msgAfterSave),x(),a.isDialogOpen()?a.closeDialogs():e.redirect&&a.navigate("/user")}}),v=h.formData,x=h.resetForm,g=h.handleSubmit,j=h.submitForm,N=h.pageReady,b=h.loading,w=h.saving,C=h.inputClassName;return b?(0,f.jsx)("div",{className:"p-3 text-center",children:(0,f.jsx)(c.G,{style:{width:"50px",height:"50px"}})}):N?(0,f.jsxs)("main",{id:"UserAddPage",className:"main-page",children:[e.showHeader&&(0,f.jsx)("section",{className:"page-section mb-3",children:(0,f.jsx)("div",{className:"container",children:(0,f.jsxs)("div",{className:"grid align-items-center",children:[!e.isSubPage&&(0,f.jsx)("div",{className:"col-fixed ",children:(0,f.jsx)(l.z,{onClick:function(){return a.navigate(-1)},label:"",className:"p-button p-button-text ",icon:"pi pi-arrow-left"})}),(0,f.jsx)("div",{className:"col ",children:(0,f.jsx)(d.D,{title:"Tambah  User",titleClass:"text-2xl text-primary font-bold",subTitleClass:"text-sm text-500",separator:!1})})]})})}),(0,f.jsx)("section",{className:"page-section ",children:(0,f.jsx)("div",{className:"container",children:(0,f.jsx)("div",{className:"grid ",children:(0,f.jsx)("div",{className:"md:col-9 sm:col-12 comp-grid",children:(0,f.jsx)("div",{children:(0,f.jsx)(r.J9,{initialValues:v,validationSchema:s,onSubmit:function(e,a){return j(e)},children:function(s){var n,c,d,m;return(0,f.jsx)(f.Fragment,{children:(0,f.jsxs)(r.l0,{className:"".concat(e.isSubPage?"":"card "),children:[(0,f.jsxs)("div",{className:"grid",children:[(0,f.jsx)("div",{className:"col-12",children:(0,f.jsxs)("div",{className:"formgrid grid",children:[(0,f.jsx)("div",{className:"col-12 md:col-3",children:"Username *"}),(0,f.jsx)("div",{className:"col-12 md:col-9",children:(0,f.jsx)(i.v,{value:s.values.username,apiPath:"components_data/user_username_exist",children:function(e){var a;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(t.o,{name:"username",onBlur:e.check,onChange:s.handleChange,value:s.values.username,label:"Username",type:"text",placeholder:"Enter Username",className:C(null===s||void 0===s||null===(a=s.errors)||void 0===a?void 0:a.username)}),(0,f.jsx)(r.Bc,{name:"username",component:"span",className:"p-error"}),!e.loading&&e.exist&&(0,f.jsx)("small",{className:"p-error",children:"Not available"}),e.loading&&(0,f.jsx)("small",{className:"text-500",children:"Checking..."})]})}})})]})}),(0,f.jsx)("div",{className:"col-12",children:(0,f.jsxs)("div",{className:"formgrid grid",children:[(0,f.jsx)("div",{className:"col-12 md:col-3",children:"Password *"}),(0,f.jsxs)("div",{className:"col-12 md:col-9",children:[(0,f.jsx)(o.r,{name:"password",value:s.values.password,onChange:s.handleChange,label:"Password",placeholder:"Enter Password",inputClassName:"w-full",toggleMask:!0,feedback:!0,className:C(null===s||void 0===s||null===(n=s.errors)||void 0===n?void 0:n.password)}),(0,f.jsx)(r.Bc,{name:"password",component:"span",className:"p-error"})]})]})}),(0,f.jsx)("div",{className:"col-12",children:(0,f.jsxs)("div",{className:"formgrid grid",children:[(0,f.jsx)("div",{className:"col-12 md:col-3",children:"Confirm Password *"}),(0,f.jsxs)("div",{className:"col-12 md:col-9",children:[(0,f.jsx)(o.r,{name:"confirm_password",id:"confirm_password",className:C(null===s||void 0===s||null===(c=s.errors)||void 0===c?void 0:c.comfirm_password),inputClassName:"w-full",feedback:!1,toggleMask:!0,value:s.values.confirm_password,onChange:s.handleChange,label:"Confirm Password",placeholder:"Confirm Password"}),(0,f.jsx)(r.Bc,{name:"confirm_password",component:"span",className:"p-error"})]})]})}),(0,f.jsx)("div",{className:"col-12",children:(0,f.jsxs)("div",{className:"formgrid grid",children:[(0,f.jsx)("div",{className:"col-12 md:col-3",children:"Email *"}),(0,f.jsx)("div",{className:"col-12 md:col-9",children:(0,f.jsx)(i.v,{value:s.values.email,apiPath:"components_data/user_email_exist",children:function(e){var a;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(t.o,{name:"email",onBlur:e.check,onChange:s.handleChange,value:s.values.email,label:"Email",type:"email",placeholder:"Enter Email",className:C(null===s||void 0===s||null===(a=s.errors)||void 0===a?void 0:a.email)}),(0,f.jsx)(r.Bc,{name:"email",component:"span",className:"p-error"}),!e.loading&&e.exist&&(0,f.jsx)("small",{className:"p-error",children:"Not available"}),e.loading&&(0,f.jsx)("small",{className:"text-500",children:"Checking..."})]})}})})]})}),(0,f.jsx)("div",{className:"col-12",children:(0,f.jsxs)("div",{className:"formgrid grid",children:[(0,f.jsx)("div",{className:"col-12 md:col-3",children:"Telp"}),(0,f.jsxs)("div",{className:"col-12 md:col-9",children:[(0,f.jsx)(t.o,{name:"telp",onChange:s.handleChange,value:s.values.telp,label:"Telp",type:"text",placeholder:"Enter Telp",className:C(null===s||void 0===s||null===(d=s.errors)||void 0===d?void 0:d.telp)}),(0,f.jsx)(r.Bc,{name:"telp",component:"span",className:"p-error"})]})]})}),(0,f.jsx)("div",{className:"col-12",children:(0,f.jsxs)("div",{className:"formgrid grid",children:[(0,f.jsx)("div",{className:"col-12 md:col-3",children:"Foto User *"}),(0,f.jsxs)("div",{className:"col-12 md:col-9",children:[(0,f.jsx)("div",{className:C(null===s||void 0===s||null===(m=s.errors)||void 0===m?void 0:m.foto_user),children:(0,f.jsx)(u.Q,{name:"foto_user",showUploadedFiles:!0,value:s.values.foto_user,uploadPath:"fileuploader/upload/foto_user",onChange:function(e){return s.setFieldValue("foto_user",e)},fileLimit:1,maxFileSize:1024,accept:".jpg,.png,.gif,.jpeg",multiple:!1,label:"Choose files or drop files here",onUploadError:function(e){return a.flashMsg("Upload error",e,"error")}})}),(0,f.jsx)(r.Bc,{name:"foto_user",component:"span",className:"p-error"})]})]})})]}),e.showFooter&&(0,f.jsx)("div",{className:"text-center my-3",children:(0,f.jsx)(l.z,{onClick:function(e){return g(e,s)},className:"p-button-primary",type:"submit",label:"Simpan",icon:"pi pi-send",loading:w})})]})})}})})})})})})]}):void 0};h.defaultProps={primaryKey:"id_user",pageName:"user",apiPath:"user/add",routeName:"useradd",submitButtonLabel:"Simpan",formValidationError:"Form is invalid",formValidationMsg:"Please complete the form",msgTitle:"Create Record",msgAfterSave:"Data Berhasil Di Simpan !",msgBeforeSave:"",showHeader:!0,showFooter:!0,redirect:!0,isSubPage:!1},a.default=h}}]);
//# sourceMappingURL=6383.042f8f06.chunk.js.map