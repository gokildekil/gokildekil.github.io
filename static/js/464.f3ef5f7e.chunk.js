"use strict";(self.webpackChunkpiket=self.webpackChunkpiket||[]).push([[464],{464:function(t,e,n){n.r(e),n.d(e,{default:function(){return j}});var s=n(4165),a=n(5861),i=n(885),r=n(3504),l=n(2791),c=n(9562),o=n(7162),d=n(919),u=n(5854),p=n(9025),x=n(1945),h=n(4072),f=n(4018),m=n(7834),v=n(1523),g=n(184);function j(){var t=(0,m.Z)(),e=(0,f.Z)(),n=(0,h.Z)(),j=(0,r.lr)(),b=(0,i.Z)(j,1)[0],N=(0,l.useState)(!1),k=(0,i.Z)(N,2),y=k[0],Z=k[1],w=(0,l.useState)(!1),S=(0,i.Z)(w,2),C=S[0],_=S[1],O=(0,l.useState)(""),P=(0,i.Z)(O,2),T=P[0],z=P[1],E=b.get("token"),I={otp_code:"",token:E},M=c.Ry().shape({otp_code:c.Z_().required().label("OTP Code")}),F={formUrl:"/auth/validateotp",formData:I,validationSchema:M,afterSubmit:function(n){n.token?(t.login(n.token),e.navigate("/home")):e.navigate(n.nextpage)}};function q(){var t,e=b.get("duration"),n=60*(e=parseInt(e)||5),s=n,a=setInterval((function(){n=parseInt(s/60,10),t=parseInt(s%60,10),z((n=n<10?"0"+n:n)+":"+(t=t<10?"0"+t:t)),--s<0&&(clearInterval(a),A("OTP has expired"),_(!0))}),1e3)}function D(){return(D=(0,a.Z)((0,s.Z)().mark((function t(){var a,i;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,Z(!0),A(null),t.next=5,n.post("/auth/resendotp",I);case 5:_(!1),q(),e.flashMsg("Success","OTP Sent Successfully","success"),t.next=15;break;case 10:t.prev=10,t.t0=t.catch(0),console.log(t.t0),i=(null===t.t0||void 0===t.t0||null===(a=t.t0.response)||void 0===a?void 0:a.data)||"Unable to resend otp",e.flashMsg("Failed",i,"error");case 15:return t.prev=15,Z(!1),t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[0,10,15,18]])})))).apply(this,arguments)}(0,l.useEffect)((function(){q()}),[E]);var R=(0,v.Z)(F),U=R.loading,V=R.errorMsg,A=R.setErrorMsg,K=R.formik,B=R.getFieldError,G=R.getErrorClass;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{className:"container",children:(0,g.jsx)("div",{className:"grid justify-content-center",children:(0,g.jsx)("div",{className:"col-12 md:col-5",children:(0,g.jsxs)("div",{className:"card",children:[(0,g.jsxs)("div",{className:"mb-4",children:[(0,g.jsxs)("div",{className:"grid align-items-center justify-content-between",children:[(0,g.jsx)("div",{className:"col-2",children:(0,g.jsx)(o.q,{className:"bg-green-500 text-white",icon:"pi pi-check-circle",size:"large"})}),(0,g.jsx)("div",{className:"col",children:(0,g.jsx)("div",{className:"text-2xl font-bold",children:"OTP Verification"})}),(0,g.jsx)("div",{className:"col-3",children:(0,g.jsx)("div",{className:"text-2xl font-bold text-info",children:T})})]}),(0,g.jsx)("div",{className:"text-primary"})]}),(0,g.jsxs)("form",{onSubmit:K.handleSubmit,children:[(0,g.jsxs)("div",{className:"grid justify-content-between",children:[(0,g.jsxs)("div",{className:"col",children:[(0,g.jsx)(p.o,{name:"otp_code",id:"otp_code",className:(0,u.AK)("w-full text-center otp-input",G("otp_code")),placeholder:"Enter OTP",value:K.values.otpCode,onChange:K.handleChange,type:"text"}),B("otp_code")]}),(0,g.jsx)("div",{className:"col-3 tetx-right",children:(0,g.jsx)(d.z,{className:"p-button-lg",loading:U,type:"submit",label:"Verify"})})]}),V&&(0,g.jsx)(x.v,{severity:"error",text:V}),(0,g.jsxs)("div",{className:"flex align-items-center justify-content-between",children:[(0,g.jsx)("div",{className:"text-sm text-500",children:"Didn't receive an OTP ?"}),(0,g.jsx)("div",{children:(0,g.jsx)(d.z,{className:"p-button-text",disabled:!C,loading:y,onClick:function(){return function(){return D.apply(this,arguments)}()},type:"button",label:"Resend..."})})]})]})]})})})}),(0,g.jsx)("style",{children:"\n\t\t\t\t.otp-input {\n\t\t\t\t\tfont-weight: bold;\n\t\t\t\t\tfont-size: 20px;\n\t\t\t\t\ttext-align: center;\n\t\t\t\t\tletter-spacing: 10px;\n\t\t\t\t}\n\t\t\t\t.otp-input::placeholder {\n\t\t\t\t\tfont-weight: normal;\n\t\t\t\t\tfont-size: 14px;\n\t\t\t\t\ttext-align: center;\n\t\t\t\t\tletter-spacing: 1px;\n\t\t\t\t}\n\t\t\t\t"})]})}}}]);
//# sourceMappingURL=464.f3ef5f7e.chunk.js.map